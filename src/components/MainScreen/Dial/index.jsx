import React, { useContext } from "react";
import ValueContext from "context/ValueContext";
import NumberButton from "./NumberButton";
import DotButton from "./DotButton";
import useStyles from "./useStyles";
import Icon1Svg from "./img/1.svg";
import Icon2Svg from "./img/2.svg";
import Icon3Svg from "./img/3.svg";
import Icon4Svg from "./img/4.svg";
import Icon5Svg from "./img/5.svg";
import Icon6Svg from "./img/6.svg";
import Icon7Svg from "./img/7.svg";
import Icon8Svg from "./img/8.svg";
import Icon9Svg from "./img/9.svg";
import Icon0Svg from "./img/0.svg";
import BackspaceButton from "./BackspaceButton";

const digitMap = {
  0: (
    <svg
      width="14"
      height="20"
      viewBox="0 0 14 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M13.78 9.607C13.78 11.245 13.6023 12.6707 13.247 13.884C12.9003 15.0887 12.415 16.0853 11.791 16.874C11.1757 17.6627 10.4433 18.252 9.594 18.642C8.75333 19.0233 7.84333 19.214 6.864 19.214C5.88467 19.214 4.97467 19.0233 4.134 18.642C3.302 18.252 2.57833 17.6627 1.963 16.874C1.34767 16.0853 0.866667 15.0887 0.52 13.884C0.173333 12.6707 0 11.245 0 9.607C0 7.96033 0.173333 6.53467 0.52 5.33C0.866667 4.12533 1.34767 3.12867 1.963 2.34C2.57833 1.55133 3.302 0.966333 4.134 0.584999C4.97467 0.195 5.88467 0 6.864 0C7.84333 0 8.75333 0.195 9.594 0.584999C10.4433 0.966333 11.1757 1.55133 11.791 2.34C12.415 3.12867 12.9003 4.12533 13.247 5.33C13.6023 6.53467 13.78 7.96033 13.78 9.607ZM10.465 9.607C10.465 8.24633 10.3653 7.11967 10.166 6.227C9.96667 5.33433 9.698 4.62367 9.36 4.095C9.03067 3.56633 8.64933 3.198 8.216 2.99C7.78267 2.77333 7.332 2.665 6.864 2.665C6.40467 2.665 5.95833 2.77333 5.525 2.99C5.10033 3.198 4.72333 3.56633 4.394 4.095C4.06467 4.62367 3.80033 5.33433 3.601 6.227C3.41033 7.11967 3.315 8.24633 3.315 9.607C3.315 10.9677 3.41033 12.0943 3.601 12.987C3.80033 13.8797 4.06467 14.5903 4.394 15.119C4.72333 15.6477 5.10033 16.0203 5.525 16.237C5.95833 16.445 6.40467 16.549 6.864 16.549C7.332 16.549 7.78267 16.445 8.216 16.237C8.64933 16.0203 9.03067 15.6477 9.36 15.119C9.698 14.5903 9.96667 13.8797 10.166 12.987C10.3653 12.0943 10.465 10.9677 10.465 9.607Z" />
    </svg>
  ),
  1: (
    <svg
      width="12"
      height="19"
      viewBox="0 0 12 19"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M11.752 16.419V18.824H1.352V16.419H5.161V5.46C5.161 5.02667 5.174 4.58033 5.2 4.121L2.496 6.383C2.34 6.50433 2.184 6.58233 2.028 6.617C1.88067 6.643 1.73767 6.643 1.599 6.617C1.469 6.591 1.352 6.54767 1.248 6.487C1.144 6.41767 1.066 6.344 1.014 6.266L0 4.875L5.733 0H8.372V16.419H11.752Z" />
    </svg>
  ),
  2: (
    <svg
      width="13"
      height="20"
      viewBox="0 0 13 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M11.765 16.016C12.1117 16.016 12.3847 16.1157 12.584 16.315C12.792 16.5057 12.896 16.7613 12.896 17.082V19.006H0V17.94C0 17.7233 0.0433333 17.498 0.13 17.264C0.225333 17.0213 0.372667 16.8047 0.572 16.614L6.279 10.894C6.75567 10.4087 7.18033 9.945 7.553 9.503C7.93433 9.061 8.25067 8.62333 8.502 8.19C8.75333 7.75667 8.944 7.319 9.074 6.877C9.21267 6.42633 9.282 5.954 9.282 5.46C9.282 5.00933 9.217 4.615 9.087 4.277C8.957 3.93033 8.77067 3.64 8.528 3.406C8.294 3.172 8.008 2.99867 7.67 2.886C7.34067 2.76467 6.968 2.704 6.552 2.704C6.17067 2.704 5.81533 2.76033 5.486 2.873C5.16533 2.977 4.87933 3.12867 4.628 3.328C4.37667 3.51867 4.16433 3.744 3.991 4.004C3.81767 4.264 3.68767 4.55 3.601 4.862C3.45367 5.26067 3.263 5.525 3.029 5.655C2.795 5.785 2.457 5.81533 2.015 5.746L0.325 5.447C0.455 4.54567 0.706333 3.757 1.079 3.081C1.45167 2.39633 1.91533 1.82867 2.47 1.378C3.03333 0.918666 3.67467 0.576333 4.394 0.350999C5.122 0.117 5.902 0 6.734 0C7.60067 0 8.39367 0.13 9.113 0.39C9.83233 0.641332 10.4477 1.001 10.959 1.469C11.4703 1.937 11.869 2.50033 12.155 3.159C12.441 3.81767 12.584 4.55 12.584 5.356C12.584 6.04933 12.48 6.69067 12.272 7.28C12.0727 7.86933 11.7997 8.43267 11.453 8.97C11.115 9.50733 10.7163 10.0273 10.257 10.53C9.79767 11.0327 9.31667 11.544 8.814 12.064L4.576 16.393C4.98333 16.2717 5.38633 16.1807 5.785 16.12C6.19233 16.0507 6.578 16.016 6.942 16.016H11.765Z" />
    </svg>
  ),
  3: (
    <svg
      width="13"
      height="20"
      viewBox="0 0 13 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M0.546 5.447C0.676 4.54567 0.927333 3.757 1.3 3.081C1.67267 2.39633 2.13633 1.82867 2.691 1.378C3.25433 0.918666 3.89567 0.576333 4.615 0.350999C5.343 0.117 6.123 0 6.955 0C7.82167 0 8.60167 0.125666 9.295 0.376999C9.997 0.619666 10.595 0.961999 11.089 1.404C11.583 1.83733 11.96 2.34867 12.22 2.938C12.4887 3.52733 12.623 4.16433 12.623 4.849C12.623 5.447 12.5537 5.97567 12.415 6.435C12.285 6.88567 12.0943 7.28 11.843 7.618C11.5917 7.956 11.2797 8.242 10.907 8.476C10.5343 8.71 10.114 8.905 9.646 9.061C10.7727 9.41633 11.6133 9.958 12.168 10.686C12.7227 11.414 13 12.3283 13 13.429C13 14.365 12.8267 15.1927 12.48 15.912C12.1333 16.6313 11.6653 17.238 11.076 17.732C10.4867 18.2173 9.802 18.5857 9.022 18.837C8.25067 19.0883 7.43167 19.214 6.565 19.214C5.62033 19.214 4.797 19.1057 4.095 18.889C3.393 18.6723 2.782 18.3517 2.262 17.927C1.742 17.5023 1.3 16.9823 0.936 16.367C0.572 15.7517 0.26 15.041 0 14.235L1.417 13.65C1.78967 13.494 2.13633 13.455 2.457 13.533C2.78633 13.6023 3.02467 13.7757 3.172 14.053C3.328 14.3563 3.497 14.6553 3.679 14.95C3.86967 15.2447 4.095 15.509 4.355 15.743C4.615 15.9683 4.91833 16.1547 5.265 16.302C5.62033 16.4407 6.04067 16.51 6.526 16.51C7.072 16.51 7.54867 16.4233 7.956 16.25C8.36333 16.068 8.70133 15.834 8.97 15.548C9.24733 15.262 9.451 14.9457 9.581 14.599C9.71967 14.2437 9.789 13.8883 9.789 13.533C9.789 13.0823 9.74133 12.675 9.646 12.311C9.55067 11.9383 9.35133 11.622 9.048 11.362C8.74467 11.102 8.307 10.8983 7.735 10.751C7.17167 10.6037 6.41333 10.53 5.46 10.53V8.242C6.24867 8.23333 6.903 8.15967 7.423 8.021C7.943 7.88233 8.35467 7.69167 8.658 7.449C8.97 7.19767 9.18667 6.89867 9.308 6.552C9.42933 6.20533 9.49 5.824 9.49 5.408C9.49 4.524 9.243 3.85233 8.749 3.393C8.255 2.93367 7.59633 2.704 6.773 2.704C6.39167 2.704 6.04067 2.76033 5.72 2.873C5.39933 2.977 5.109 3.12867 4.849 3.328C4.59767 3.51867 4.38533 3.744 4.212 4.004C4.03867 4.264 3.90867 4.55 3.822 4.862C3.67467 5.26067 3.47967 5.525 3.237 5.655C3.003 5.785 2.66933 5.81533 2.236 5.746L0.546 5.447Z" />
    </svg>
  ),
  4: (
    <svg
      width="15"
      height="19"
      viewBox="0 0 15 19"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M9.152 11.726V5.577C9.152 4.99633 9.191 4.355 9.269 3.653L3.432 11.726H9.152ZM14.313 11.726V13.585C14.313 13.7583 14.2567 13.91 14.144 14.04C14.0313 14.1613 13.871 14.222 13.663 14.222H11.947V18.811H9.152V14.222H1.222C1.00533 14.222 0.814667 14.157 0.65 14.027C0.485333 13.8883 0.381333 13.7193 0.338 13.52L0 11.895L8.905 0H11.947V11.726H14.313Z" />
    </svg>
  ),
  5: (
    <svg
      width="13"
      height="20"
      viewBox="0 0 13 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M4.147 6.825C4.563 6.73833 4.96167 6.67767 5.343 6.643C5.72433 6.59967 6.09267 6.578 6.448 6.578C7.436 6.578 8.307 6.72533 9.061 7.02C9.815 7.31467 10.4477 7.722 10.959 8.242C11.4703 8.762 11.856 9.373 12.116 10.075C12.376 10.7683 12.506 11.518 12.506 12.324C12.506 13.3207 12.3283 14.2307 11.973 15.054C11.6263 15.8773 11.141 16.5837 10.517 17.173C9.893 17.7537 9.152 18.2043 8.294 18.525C7.44467 18.8457 6.51733 19.006 5.512 19.006C4.92267 19.006 4.36367 18.9453 3.835 18.824C3.30633 18.7027 2.808 18.5423 2.34 18.343C1.88067 18.135 1.45167 17.901 1.053 17.641C0.663 17.3723 0.312 17.0907 0 16.796L0.988 15.431C1.196 15.1363 1.469 14.989 1.807 14.989C2.02367 14.989 2.24467 15.0583 2.47 15.197C2.69533 15.3357 2.951 15.4873 3.237 15.652C3.53167 15.8167 3.874 15.9683 4.264 16.107C4.66267 16.2457 5.13933 16.315 5.694 16.315C6.28333 16.315 6.80333 16.2197 7.254 16.029C7.70467 15.8383 8.07733 15.574 8.372 15.236C8.67533 14.8893 8.90067 14.482 9.048 14.014C9.204 13.5373 9.282 13.0217 9.282 12.467C9.282 11.4443 8.983 10.647 8.385 10.075C7.79567 9.49433 6.92033 9.204 5.759 9.204C4.86633 9.204 3.952 9.36867 3.016 9.698L1.014 9.126L2.574 0H11.856V1.365C11.856 1.82433 11.713 2.197 11.427 2.483C11.141 2.769 10.6557 2.912 9.971 2.912H4.81L4.147 6.825Z" />
    </svg>
  ),
  6: (
    <svg
      width="14"
      height="20"
      viewBox="0 0 14 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M5.694 6.825L5.044 7.631C5.408 7.449 5.798 7.31033 6.214 7.215C6.63867 7.111 7.09367 7.059 7.579 7.059C8.28967 7.059 8.97867 7.176 9.646 7.41C10.322 7.644 10.9157 7.99933 11.427 8.476C11.9383 8.944 12.35 9.529 12.662 10.231C12.974 10.933 13.13 11.752 13.13 12.688C13.13 13.5633 12.9697 14.3867 12.649 15.158C12.3283 15.9207 11.8777 16.588 11.297 17.16C10.7163 17.732 10.0143 18.1827 9.191 18.512C8.37633 18.8413 7.475 19.006 6.487 19.006C5.48167 19.006 4.58033 18.8457 3.783 18.525C2.98567 18.2043 2.30533 17.758 1.742 17.186C1.17867 16.6053 0.745333 15.912 0.442 15.106C0.147333 14.2913 0 13.39 0 12.402C0 11.518 0.177667 10.6123 0.533 9.685C0.897 8.749 1.456 7.77833 2.21 6.773L6.695 0.754001C6.851 0.546001 7.07633 0.368334 7.371 0.221001C7.67433 0.073667 8.021 0 8.411 0H11.271L5.694 6.825ZM6.422 16.38C6.93333 16.38 7.40133 16.2933 7.826 16.12C8.25933 15.9467 8.62767 15.704 8.931 15.392C9.243 15.08 9.48567 14.716 9.659 14.3C9.83233 13.8753 9.919 13.416 9.919 12.922C9.919 12.3847 9.83667 11.9037 9.672 11.479C9.50733 11.0457 9.27333 10.6817 8.97 10.387C8.66667 10.0837 8.30267 9.854 7.878 9.698C7.45333 9.542 6.98533 9.464 6.474 9.464C5.96267 9.464 5.499 9.55067 5.083 9.724C4.667 9.89733 4.31167 10.14 4.017 10.452C3.72233 10.7553 3.49267 11.1193 3.328 11.544C3.16333 11.96 3.081 12.4107 3.081 12.896C3.081 13.416 3.15033 13.8927 3.289 14.326C3.43633 14.7507 3.64867 15.1147 3.926 15.418C4.212 15.7213 4.563 15.9597 4.979 16.133C5.395 16.2977 5.876 16.38 6.422 16.38Z" />
    </svg>
  ),
  7: (
    <svg
      width="13"
      height="19"
      viewBox="0 0 13 19"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M12.987 0V1.391C12.987 1.807 12.9437 2.145 12.857 2.405C12.7703 2.65633 12.6837 2.86867 12.597 3.042L5.473 17.706C5.32567 18.0093 5.11767 18.2693 4.849 18.486C4.58033 18.694 4.22067 18.798 3.77 18.798H1.443L8.71 4.433C8.87467 4.13833 9.035 3.86967 9.191 3.627C9.35567 3.37567 9.53767 3.13733 9.737 2.912H0.741C0.541667 2.912 0.368333 2.83833 0.221 2.691C0.0736667 2.54367 0 2.37033 0 2.171V0H12.987Z" />
    </svg>
  ),
  8: (
    <svg
      width="14"
      height="20"
      viewBox="0 0 14 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M6.526 16.705C7.05467 16.705 7.51833 16.6313 7.917 16.484C8.31567 16.328 8.64933 16.1157 8.918 15.847C9.19533 15.5783 9.40333 15.2577 9.542 14.885C9.68067 14.5123 9.75 14.1093 9.75 13.676C9.75 12.6447 9.464 11.8647 8.892 11.336C8.32 10.8073 7.53133 10.543 6.526 10.543C5.52067 10.543 4.732 10.8073 4.16 11.336C3.588 11.8647 3.302 12.6447 3.302 13.676C3.302 14.1093 3.37133 14.5123 3.51 14.885C3.64867 15.2577 3.85233 15.5783 4.121 15.847C4.39833 16.1157 4.73633 16.328 5.135 16.484C5.53367 16.6313 5.99733 16.705 6.526 16.705ZM6.526 2.418C6.04933 2.418 5.63767 2.49167 5.291 2.639C4.94433 2.78633 4.654 2.98567 4.42 3.237C4.19467 3.47967 4.02567 3.76133 3.913 4.082C3.809 4.40267 3.757 4.74067 3.757 5.096C3.757 5.46867 3.80033 5.83267 3.887 6.188C3.98233 6.53467 4.13833 6.84667 4.355 7.124C4.57167 7.39267 4.85767 7.60933 5.213 7.774C5.56833 7.93867 6.006 8.021 6.526 8.021C7.046 8.021 7.48367 7.93867 7.839 7.774C8.19433 7.60933 8.48033 7.39267 8.697 7.124C8.91367 6.84667 9.06533 6.53467 9.152 6.188C9.24733 5.83267 9.295 5.46867 9.295 5.096C9.295 4.74067 9.23867 4.40267 9.126 4.082C9.01333 3.76133 8.84433 3.47967 8.619 3.237C8.39367 2.98567 8.10767 2.78633 7.761 2.639C7.41433 2.49167 7.00267 2.418 6.526 2.418ZM9.698 9.204C10.842 9.57667 11.687 10.1487 12.233 10.92C12.779 11.6827 13.052 12.6187 13.052 13.728C13.052 14.56 12.8917 15.314 12.571 15.99C12.259 16.666 11.817 17.2423 11.245 17.719C10.673 18.1957 9.984 18.564 9.178 18.824C8.38067 19.084 7.49667 19.214 6.526 19.214C5.55533 19.214 4.667 19.084 3.861 18.824C3.06367 18.564 2.379 18.1957 1.807 17.719C1.235 17.2423 0.788667 16.666 0.468 15.99C0.156 15.314 0 14.56 0 13.728C0 12.6187 0.273 11.6827 0.819 10.92C1.365 10.1487 2.21 9.57667 3.354 9.204C2.444 8.82267 1.75933 8.281 1.3 7.579C0.849333 6.877 0.624 6.032 0.624 5.044C0.624 4.33333 0.767 3.67033 1.053 3.055C1.34767 2.43967 1.755 1.90667 2.275 1.456C2.795 0.996666 3.41467 0.641332 4.134 0.39C4.862 0.13 5.65933 0 6.526 0C7.39267 0 8.18567 0.13 8.905 0.39C9.633 0.641332 10.257 0.996666 10.777 1.456C11.297 1.90667 11.7 2.43967 11.986 3.055C12.2807 3.67033 12.428 4.33333 12.428 5.044C12.428 6.032 12.1983 6.877 11.739 7.579C11.2883 8.281 10.608 8.82267 9.698 9.204Z" />
    </svg>
  ),
  9: (
    <svg
      width="13"
      height="20"
      viewBox="0 0 13 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M3.211 5.85C3.211 6.89867 3.47967 7.70033 4.017 8.255C4.563 8.801 5.33433 9.074 6.331 9.074C6.851 9.074 7.31467 8.99167 7.722 8.827C8.12933 8.66233 8.47167 8.437 8.749 8.151C9.02633 7.865 9.23433 7.527 9.373 7.137C9.52033 6.747 9.594 6.32667 9.594 5.876C9.594 5.36467 9.516 4.90967 9.36 4.511C9.204 4.10367 8.983 3.76133 8.697 3.484C8.411 3.20667 8.06867 2.99433 7.67 2.847C7.28 2.69967 6.851 2.626 6.383 2.626C5.89767 2.626 5.46 2.70833 5.07 2.873C4.68 3.029 4.34633 3.25 4.069 3.536C3.79167 3.822 3.57933 4.16433 3.432 4.563C3.28467 4.953 3.211 5.382 3.211 5.85ZM7.475 11.713C7.62233 11.531 7.761 11.3533 7.891 11.18C8.021 11.0067 8.14667 10.8333 8.268 10.66C7.83467 10.9373 7.358 11.1497 6.838 11.297C6.318 11.4357 5.772 11.505 5.2 11.505C4.55 11.505 3.913 11.3923 3.289 11.167C2.665 10.9417 2.11033 10.6037 1.625 10.153C1.13967 9.69367 0.745333 9.13033 0.442 8.463C0.147333 7.787 0 6.99833 0 6.097C0 5.25633 0.156 4.46767 0.468 3.731C0.78 2.99433 1.21767 2.34867 1.781 1.794C2.34433 1.23933 3.02033 0.801666 3.809 0.480999C4.59767 0.160333 5.46867 0 6.422 0C7.384 0 8.24633 0.151667 9.009 0.455C9.78033 0.758333 10.4347 1.183 10.972 1.729C11.518 2.275 11.934 2.92933 12.22 3.692C12.5147 4.45467 12.662 5.291 12.662 6.201C12.662 6.78167 12.61 7.332 12.506 7.852C12.4107 8.372 12.272 8.87467 12.09 9.36C11.908 9.83667 11.687 10.3047 11.427 10.764C11.167 11.2233 10.8767 11.6783 10.556 12.129L6.253 18.265C6.10567 18.473 5.88467 18.6507 5.59 18.798C5.29533 18.9367 4.96167 19.006 4.589 19.006H1.638L7.475 11.713Z" />
    </svg>
  ),
};

function Dial() {
  const MAX_LENGTH = 12;
  const DOT = ".";

  const classes = useStyles();
  const { setValue, value } = useContext(ValueContext);

  function handleBackspaceButtonClick() {
    setValue((prevValue) => {
      const nextValue = prevValue.substring(0, prevValue.length - 1);

      return nextValue;
    });
  }

  function handleDigitButtonClick(digit) {
    // First zero limitations
    if (value === "0" && digit !== DOT) {
      return setValue(`${digit}`);
    }

    // Dot limitations
    const isDot = digit === DOT;
    const split = value.split(DOT);
    const hasDot = split.length === 2;

    if (!value && isDot) {
      return null;
    }

    if (hasDot && (isDot || split[1].length === 2)) {
      return null;
    } else if (isDot && value.length > MAX_LENGTH - 2) {
      return null;
    }

    // Length limitations
    if (value.replace(DOT, "").length >= MAX_LENGTH) {
      return null;
    }

    setValue(value + digit);
  }

  return (
    <div className={classes.root}>
      <div className={classes.grid}>
        {new Array(9).fill(0).map((v, index) => (
          <NumberButton
            label={digitMap[index + 1]}
            onClick={() => handleDigitButtonClick(index + 1)}
            key={index + 1}
          />
        ))}

        <DotButton onClick={() => handleDigitButtonClick(DOT)} />

        <NumberButton
          label={digitMap[0]}
          onClick={() => handleDigitButtonClick(0)}
        />

        <BackspaceButton onClick={handleBackspaceButtonClick} />
      </div>
    </div>
  );
}

Dial.propTypes = {};

export default Dial;
